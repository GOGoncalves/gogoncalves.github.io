<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HealthSystem - Cadastro de usuário</title>
    <link href="assets/img/favicon.png" rel="icon">
    <link rel="stylesheet" href="assets/css/style.css">

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
        rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="assets/vendor/fontawesome-free/css/all.min.css" rel="stylesheet">
    <link href="assets/vendor/animate.css/animate.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
    <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

    <!-- Template Main CSS File -->
    <link href="assets/css/style.css" rel="stylesheet">
</head>

<body>
    <!-- ======= Top Bar ======= -->
    <div id="topbar" class="d-flex align-items-center fixed-top">
        <div class="container d-flex justify-content-between">
            <div class="contact-info d-flex align-items-center">
                <i class="bi bi-envelope"></i> <a href="mailto:contact@example.com">suporte@healthsystem.com</a>
                <i class="bi bi-phone"></i> +55 (11) 3589-4043
            </div>
            <div class="d-none d-lg-flex social-links align-items-center">
                <a href="#" class="twitter"><i class="bi bi-twitter"></i></a>
                <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
                <a href="#" class="instagram"><i class="bi bi-instagram"></i></a>
                <a href="#" class="linkedin"><i class="bi bi-linkedin"></i></i></a>
            </div>
        </div>
    </div>

    <!-- ======= Header ======= -->
    <header id="header" class="fixed-top">
        <div class="container d-flex align-items-center">

            <h1 class="logo me-auto"><a href="index.html">HealthSystem</a></h1>

            <nav id="navbar" class="navbar order-last order-lg-0">
                <ul>
                    <li><a class="nav-link scrollto active" href="index.html#hero">Home</a></li>
                    <li><a class="nav-link scrollto" href="index.html#about">Sobre</a></li>
                    <li><a class="nav-link scrollto" href="index.html#services">Serviços</a></li>
                    <li><a class="nav-link scrollto" href="index.html#doctors">Equipe</a></li>
                    <li><a class="nav-link scrollto" href="index.html#contact">Contato</a></li>
                </ul>
                <i class="bi bi-list mobile-nav-toggle"></i>
            </nav><!-- .navbar -->

            <a href="cadastro-empresa.html" class="appointment-btn scrollto"><span
                    class="d-none d-md-inline">Cadastro</span></a>
            <a href="login.html" class="appointment-btn scrollto"><span class="d-none d-md-inline">Login</span></a>

        </div>
    </header><!-- End Header -->

    <section class="ftco-section">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-6 text-center mb-5">
                </div>
            </div>
            <div class="row justify-content-center">
                <div class="col-md-6 col-lg-5">
                    <div style="display: flex; flex-direction: column; align-items: center;" class="login-wrap p-4 p-md-5">
                        <div class="icon d-flex align-items-center justify-content-center">
                            <img class="imagemUsuario"
                                src="./assets/img/icone-usuario.png">

                            <span class="fa fa-user-o"></span>

                        </div>
                        <h3>Cadastrar usuário</h3>
                        <form action="#" onsubmit="return false" class="login-form">
                            <div class="form-group">
                                <label for="empresa">Identificação da empresa:</label>
                                <input type="number" class="form-control rounded-left" id="id_fkEmpresa"
                                    placeholder="Ex:. 392132 " required>
                            </div>
                            <div class="form-group">
                                <label for="credencial">Credencial de permissão:</label>
                                <input type="number" class="form-control rounded-left" id="id_fkCredencial"
                                    placeholder="Ex:. 392132 " required>
                            </div>
                            <div class="form-group">
                                <label for="nome">Nome completo:</label>
                                <input type="text" class="form-control rounded-left" id="id_nome"
                                    placeholder="Nome completo" required>
                            </div>
                            <div class="form-group e-m">
                                <label for="email">Email:</label>
                                <input type="email" class="form-control rounded-left" id="id_email" placeholder="Email"
                                    onkeyup="pesquisacep(this.value)" required>
                            </div>
                            <div class="form-group e-m">
                                <label for="senha">Senha:</label>
                                <input type="password" class="form-control rounded-left" id="id_password"
                                    placeholder="Digite sua senha" required>
                            </div>
                            <div class="form-group e-m">
                                <label for="senha">Confirmação de senha:</label>
                                <input type="password" class="form-control rounded-left" id="id_passconfirmation"
                                    placeholder="Confirme sua senha" required>
                            </div>
                          
                            <div class="form-group d-md-flex">
                                <div class="w-50">
                                </div>
                                <div class="w-50 text-md-right">
                                </div>
                            </div>
                            <h3 class="text-center mb-4"> <a href="login.html">Possui uma conta? Entre aqui.</a></h3>
                            <div class="form-group">
                                <button onclick="cadastrar()" class="btn btn-primary rounded submit p-3 px-5">Cadastrar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
</body>

</html>
<script>
    function cadastrar() {
        // aguardar();

        //Recupere o valor da nova input pelo nome do id
        // Agora vá para o método fetch logo abaixo
        var fkEmpresa = id_fkEmpresa.value;
        var nome = id_nome.value;
        var emailVar = id_email.value;
        var senhaVar = id_password.value;
        var confirmacaoSenhaVar = id_passconfirmation.value;
        var fkCredencial = id_fkCredencial.value; 

        console.log(fkEmpresa)
        console.log(fkCredencial)

        // continuar()
        
        console.log(nome)
        // if (senhaVar != confirmacaoSenhaVar) {
        //     mensagem_erro.style.display = "block"

        //     finalizarAguardar();
        //     return false;    
        // } 
        // else {
        //     setInterval(sumirMensagem, 5000)
        // }

        // if (nomeVar == "" || emailVar == "" || senhaVar == "" || confirmacaoSenhaVar == "") {
        //     mensagem_erro.style.display = "block"

        //     finalizarAguardar();
        //     return false;
        // }
        // else {
        //     setInterval(sumirMensagem, 5000)
        // }

        // Enviando o valor da nova input
        fetch("/usuarios/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                fkEmpresaServer: fkEmpresa,
                nomeServer: nome,
                emailServer: emailVar,
                passwordServer: senhaVar,
                fkCredencialServer: fkCredencial
            })
        }).then(function (resposta) {

console.log("resposta: ", resposta);

if (resposta.ok) {
    alert("Cadastro realizado com sucesso!")

    window.location = "login.html";

} else {
    throw ("Houve um erro ao tentar realizar o cadastro!");
}
}).catch(function (resposta) {
    console.log(`passei no fetch`);
    console.log(`#ERRO: ${resposta}`);
});
console.log(`Saí do fetch`);
return false;
    };

</script>